(function() {
  tinymce.PluginManager.add('smallcaps', function (editor) {
    editor.on('init', function () {
      editor.formatter.register('smallcaps', {inline : 'span', classes: 'sc'});
    });

    editor.ui.registry.addToggleButton('smallcaps', {
      text: 'Cᴀᴘ',
      tooltip: 'Small Caps',
      onAction: function () {
        editor.execCommand('mceToggleFormat', false, 'smallcaps');
      },
      onSetup: function (buttonApi) {
        var nodeChangeHandler = function() {
          buttonApi.setActive(editor.formatter.match('smallcaps'));
        };
        editor.on('NodeChange', nodeChangeHandler);
        return function() {
          editor.off('NodeChange', nodeChangeHandler);
        };
      },
    });
  });

  tinymce.PluginManager.requireLangPack('smallcaps', 'fr_FR');
})();
